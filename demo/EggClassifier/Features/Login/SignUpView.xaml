<UserControl x:Class="EggClassifier.Features.Login.SignUpView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="680" d:DesignWidth="1060">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
    <Grid VerticalAlignment="Center" HorizontalAlignment="Center" Margin="0,20">
        <Border Style="{StaticResource CardStyle}" Padding="30" MinWidth="450" MaxWidth="500">
            <StackPanel>
                <TextBlock Text="회원가입"
                           FontSize="24" FontWeight="Bold"
                           Foreground="{StaticResource TextBrush}"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,25"/>

                <!-- 아이디 -->
                <TextBlock Text="아이디"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           Margin="0,0,0,5"/>
                <TextBox Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"
                         FontSize="14" Padding="10,8"
                         Margin="0,0,0,12"/>

                <!-- 비밀번호 -->
                <TextBlock Text="비밀번호"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           Margin="0,0,0,5"/>
                <PasswordBox x:Name="PasswordBox"
                             FontSize="14" Padding="10,8"
                             Margin="0,0,0,12"
                             PasswordChanged="PasswordBox_PasswordChanged"/>

                <!-- 비밀번호 확인 -->
                <TextBlock Text="비밀번호 확인"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           Margin="0,0,0,5"/>
                <PasswordBox x:Name="PasswordConfirmBox"
                             FontSize="14" Padding="10,8"
                             Margin="0,0,0,4"
                             PasswordChanged="PasswordConfirmBox_PasswordChanged"/>
                <!-- 비밀번호 일치 여부 메시지 -->
                <TextBlock Text="{Binding PasswordMatchMessage}"
                           FontSize="11"
                           Margin="2,0,0,12">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="{StaticResource DangerBrush}"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsPasswordMatch}" Value="True">
                                    <Setter Property="Foreground" Value="{StaticResource SuccessBrush}"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

                <!-- 얼굴 등록 섹션 -->
                <Border Background="#252525" CornerRadius="5" Padding="15" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="얼굴 등록"
                                   FontSize="16" FontWeight="SemiBold"
                                   Foreground="{StaticResource TextBrush}"
                                   Margin="0,0,0,10"/>

                        <!-- 웹캠 프리뷰 (활성화 시) -->
                        <Border Background="#1E1E1E" CornerRadius="5"
                                Height="260" Margin="0,0,0,10"
                                Visibility="{Binding IsWebcamActive, Converter={StaticResource BoolToVis}}">
                            <Image Source="{Binding CurrentFrame}"
                                   Stretch="Uniform"/>
                        </Border>

                        <!-- 얼굴 상태 메시지 -->
                        <TextBlock Text="{Binding FaceStatusMessage}"
                                   Foreground="{StaticResource WarningBrush}"
                                   FontSize="12"
                                   HorizontalAlignment="Center"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,10"/>

                        <!-- 촬영된 사진 미리보기 (캡처 완료 시) -->
                        <Border Background="#1E1E1E" CornerRadius="5"
                                Height="260" Margin="0,0,0,10"
                                Visibility="{Binding IsFaceCaptured, Converter={StaticResource BoolToVis}}">
                            <Image Source="{Binding FaceThumbnail}"
                                   Stretch="Uniform"/>
                        </Border>

                        <!-- 캡처 완료: 확인 / 재촬영 버튼 -->
                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Center"
                                    Margin="0,0,0,5"
                                    Visibility="{Binding IsFaceCaptured, Converter={StaticResource BoolToVis}}">
                            <Button Content="확인"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Command="{Binding ConfirmFaceCommand}"
                                    Margin="0,0,8,0"/>
                            <Button Content="재촬영"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Command="{Binding RetakeFaceCommand}"
                                    Background="#FF9800"/>
                        </StackPanel>

                        <!-- 캡처 전 버튼들 -->
                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Center">
                            <!-- 얼굴 등록 시작 버튼 -->
                            <Button Content="얼굴 등록"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Command="{Binding StartFaceCaptureCommand}"
                                    Background="#FF9800"
                                    Visibility="{Binding ShowStartButton, Converter={StaticResource BoolToVis}}"/>

                            <!-- 촬영 버튼 (웹캠 활성화 시) -->
                            <Button Content="촬영"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Command="{Binding CaptureFaceCommand}"
                                    Visibility="{Binding IsWebcamActive, Converter={StaticResource BoolToVis}}"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- 가입하기 버튼 -->
                <Button Content="가입하기"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding RegisterCommand}"
                        HorizontalAlignment="Stretch"
                        Margin="0,0,0,10"/>

                <!-- 로그인으로 돌아가기 -->
                <Button Content="로그인으로 돌아가기"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding NavigateToLoginCommand}"
                        HorizontalAlignment="Stretch"
                        Background="#555555"
                        Margin="0,0,0,10"/>

                <!-- 상태 메시지 -->
                <TextBlock Text="{Binding StatusMessage}"
                           FontSize="12"
                           HorizontalAlignment="Center"
                           TextWrapping="Wrap">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="{StaticResource SuccessBrush}"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsStatusError}" Value="True">
                                    <Setter Property="Foreground" Value="{StaticResource DangerBrush}"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </StackPanel>
        </Border>
    </Grid>
    </ScrollViewer>
</UserControl>
